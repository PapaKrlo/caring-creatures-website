<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mint Page</title>
    <link rel="icon" type="image/x-icon" href="img/favicon.png" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="mint-styles.css" />
    <script src="https://unpkg.com/@crossmint/client-sdk-vanilla-ui@0.1.0/lib/index.global.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  </head>
  <body>
    <div class="container-mintpg row d-flex justify-content-center">
      <section class="col-md-9 justify-content-center">
        <h1 class="text-center mt-5">CARING CREATURES</h1>
        <h3 class="text-center text-white">Join our caring Kingdom!</h3>
        <div class="row justify-content-center">
          <div class="col-lg-6">
            <div class="card bg-dark mt-3">
              
              <div
                class="progress mb-2"
                role="progressbar"
                aria-label="Basic example"
                aria-valuenow="15"
                aria-valuemin="0"
                aria-valuemax="100"
              >
                <div class="position-absolute text-progress">
                  <p id="totalSupply" class="text-sm mb-0"></p>
                </div>
                <div
                  id="progress-supply"
                  class="progress-bar"
                  style="width: 100%"
                ></div>
                <!-- <div class="w-100 d-flex justify-content-center">
                  
                </div> -->
              </div>

              <section class="tf-section sec">
                <article class="a1 mt-2">
                  <div class="w-100">
                    <ul class="ul">
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/01.png" />
                      </li>
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/02.png" />
                      </li>
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/03.png" />
                      </li>
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/04.png" />
                      </li>
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/34.png" />
                      </li>
                    </ul>
                  </div>
                  <div class="w-100">
                    <ul class="ul">
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/05.png" />
                      </li>
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/06.png" />
                      </li>
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/07.png" />
                      </li>
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/24.png" />
                      </li>
                      <li class="liEx">
                        <img class="w-100 rounded mx-2" src="img/08.png" />
                      </li>
                    </ul>
                  </div>
                </article>
              </section>

              <div class="card-body">
                <div >
                  <div class="d-flex">
                    <h5 class="card-title">Price (in ETH)</h5>
                    <!-- <p>(in ETH)</p> -->
                  </div>
                  
                  <p class="disclaimer">Choose what feels right for you ðŸ™‚</p>
                 
                </div>
                
                <div class="d-flex w-100 justify-content-between">
                  <button autofocus onclick="updatePriceLabel(0.01);" class="price-btn btn" value="0.01">0.01</button>
                  <button onclick="updatePriceLabel(0.03);" class="price-btn btn" value="0.03">0.03</button>
                  <button onclick="updatePriceLabel(0.05);" class="price-btn btn" value="0.05">0.05</button>
                  <button onclick="updatePriceLabel(0.07);" class="price-btn btn" value="0.07">0.07</button>
                </div>
                <div class="d-flex justify-content-between mt-3">
                  <p>ETHER RATE:</p>
                  <p id="ethPrice" class="mb-0 mb-3 text-end">Loading...</p>
                </div>

                <!-- <p id="ethPrice">Loading...</p> -->
                <h5 class="card-title mt-4">Number of NFTs</h5>
                <div class="mb-5 mt-3">
                  <div class="quantity-input">
                    <button class="quantity-button minus">-</button>
                    <input
                      id="nftQuantity"
                      type="numeric"
                      class="form-control quantity-input-field"
                      min="1"
                      max="25"
                      step="1"
                      value="1"
                      onKeyDown="return false"
                      onchange="updateQuantityLabel(this.value, ethPrice); "
                    />
                    <button class="quantity-button plus">+</button>
                  </div>  
              </div>
               
                <div class="w-100 mt-5">
                  <div class="d-flex justify-content-end">
                    <p class="mb-0" id="priceLabel">0.01 ETH</p>
                    <p class="mb-0">&nbsp x &nbsp</p>                
                    <p class="mb-0" id="quantityLabel">1 NFT</p>
                  </div>
                  <div class="d-flex justify-content-between">
                    <div class="d-flex w-100 h-100">
                      <p id="" class="pt-2 mb-3">ESTIMATED TOTAL</p>
                      <a
                        class="h-100"
                        data-bs-custom-class="custom-tooltip"
                        data-bs-toggle="tooltip"
                        data-bs-placement="right"
                        data-bs-title="This total does not include gas fees"
                        ><img class="info pb-0 pt-2" src="icons/infoIcon.png"
                      /></a>
                    </div>
                    <div>
                      <p id="totalToPay" class="pt-2 mb-3 text-end text-nowrap">
                        0.01 ETH
                      </p>
                    </div>
                  </div>
                  <!-- <p class="text-sm warning-text">If you get an 'NFT count must be a string or number' error, just move the sliders before clicking Mint :)</p> -->

                  <button
                    onClick="mintNFT()"
                    class="mint-button btn mt-3 p-3 w-100"
                    id="mintButton"
                  >
                    BUY WITH CRYPTO WALLET
                  </button>
                  <crossmint-pay-button
                    id="xmint-btn"
                    class="w-100"
                    clientId="b18c1b28-e200-45c1-9ece-5a5b6d9c56a4"
                    mintConfig='{
                      "type":"erc-721",
                      "quantity":1,
                      "totalPrice":"0.01",
                    }'
                    environment="production"
                  />
                  
                </div>
                
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
    <div
      class="modal fade modal-dialog-scrollable"
      id="not-connected"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">
              No MetaMask detected!
            </h1>
            <button
              type="button"
              class="btn-close bg-light"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>
              To mint with crypto wallet you need to have MetaMask installed in
              your browser.
            </p>
            <div class="w-100 d-flex justify-content-center">
              <img class="w-75" src="img/026.png" />
            </div>
            <div class="w-100 d-flex justify-content-center">
              <a href="https://metamask.io/" target="_blank"
                ><button
                  type="button"
                  class="btn bg-dark text-white btn-modal mt-3"
                >
                  Download Metamask here
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="15"
                    height="15"
                    fill="currentColor"
                    class="bi bi-box-arrow-up-right"
                    viewBox="0 0 16 16"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"
                    />
                    <path
                      fill-rule="evenodd"
                      d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"
                    />
                  </svg></button
              ></a>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <div
      class="modal fade modal-dialog-scrollable"
      id="loading"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
      
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Making a caring Kingdom</h1> 
          </div>
          <div class="modal-body">
            <p>
              Minting in progress...
            </p>
            <div class="w-100 d-flex justify-content-center">
              <img id="" class="w-75" src="img/load-gif.gif" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <div
      class="modal fade modal-dialog-scrollable"
      id="success"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
       
        <div class="modal-content successful">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Success!</h1>
            <button
              type="button"
              class="btn-close bg-light"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>
              Nice creature! Your purchase was successful. Visit OpenSea to see
              all minted Creatures.
            </p>
            <div class="w-100 d-flex justify-content-center">
              <img id="my-nft" class="w-75" src="img/successCC.png" />
            </div>
            <div class="w-100 d-flex justify-content-center">
              <a
                href="https://opensea.io/collection/caring-creatures-club"
                target="_blank"
                ><button
                  type="button"
                  class="btn bg-dark text-white btn-modal mt-3"
                >
                  Take me to OpenSea
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="15"
                    height="15"
                    fill="currentColor"
                    class="bi bi-box-arrow-up-right"
                    viewBox="0 0 16 16"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"
                    />
                    <path
                      fill-rule="evenodd"
                      d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"
                    />
                  </svg></button
              ></a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div
      class="modal fade modal-dialog-scrollable"
      id="fail"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">
              Mint Failed :(
            </h1>
            <button
              type="button"
              class="btn-close bg-light"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>
              The mint was not successful. Please feel free to try again.
            </p>
            <div class="w-100 d-flex justify-content-center">
              <img class="w-75" src="img/026.png" />
            </div>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
    ></script>
    <script src="index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script>
      // $("price-btn").click(function() {
      // $(this).toggleClass("active");
      // });
      $(".price-btn").click(function(){ // when any button is clicked
        $(".price-btn").removeClass("actived"); //delete all "active" classes from all buttons
        $(this).addClass("actived"); //assign the "active" class only to the one that was clicked
        return false;
      });
      //INDEXJS LOGIC

      let currPrice = 0.0;
      function updatePriceLabel(value) {
        document.getElementById("priceLabel").innerText = value + " ETH";
        let qty = document.getElementById("nftQuantity").value;
        currPrice = value;
        let mintConfigObj = {
          type: "erc-721",
          totalPrice: Number(qty*value).toFixed(3),
          quantity: qty
        }
        let mintConfigJson = JSON.stringify(mintConfigObj);

        // finally update the button config
        document.getElementById('xmint-btn').setAttribute('mintConfig', mintConfigJson);
        document.getElementById('totalToPay').textContent = `${Number(qty*value).toFixed(2)} ETH`
      }

      function updateQuantityLabel(value) {
        document.getElementById("quantityLabel").innerText =
          value + " NFT" + (value > 1 ? "s" : "");
        let price = currPrice;

          let mintConfigObj = {
            type: "erc-721",
            totalPrice: Number(price*value).toFixed(3),
            quantity: value.toString()
          }
          let mintConfigJson = JSON.stringify(mintConfigObj);
        
          // finally update the button config
          document.getElementById('xmint-btn').setAttribute('mintConfig', mintConfigJson);
          document.getElementById('totalToPay').textContent = `${Number(price*value).toFixed(2)} ETH`
      }

      //PLUS AND MINUS 
      const minusButton = document.querySelector('.quantity-button.minus');
      const plusButton = document.querySelector('.quantity-button.plus');

      // Get the quantity input field
      const quantityInput = document.querySelector('.quantity-input-field');
      const quantityLabel = document.getElementById("quantityLabel")
      // Add click event listeners to the buttons
      minusButton.addEventListener('click', function() {
        // Decrease the quantity by 1, ensuring it stays within the defined range
        if (parseInt(quantityInput.value) > parseInt(quantityInput.min)) {
          quantityInput.value = parseInt(quantityInput.value) - 1;
          updateQuantityLabel(quantityInput.value)
        }
      });

      plusButton.addEventListener('click', function() {
        // Increase the quantity by 1, ensuring it stays within the defined range
        if (parseInt(quantityInput.value) < parseInt(quantityInput.max)) {
          quantityInput.value = parseInt(quantityInput.value) + 1;
          quantityLabel.value = quantityInput.value;
          updateQuantityLabel(quantityInput.value)

        }
      });
      
      //SET DEFAULT VALUE
      let mintConfigObj = {
        type: "erc-721",
        totalPrice: "0.01",
        quantity: 1,
      };
      let mintConfigJson = JSON.stringify(mintConfigObj);

      // finally update the button config
      document
        .getElementById("xmint-btn")
        .setAttribute("mintConfig", mintConfigJson);

      //GET ETH PRICE
      const ethereumPriceElement = document.getElementById("ethPrice");

      let ethPrice = 0;
      async function fetchEthereumPrice() {
        try {
          const response = await fetch(
            "https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=gbp"
          );
          const data = await response.json();
          const ethereumPrice = data.ethereum.gbp;

          ethereumPriceElement.textContent = `0.01 ETH = Â£${Number(
            ethereumPrice * 0.01
          ).toFixed(2)}`;

          ethPrice = ethereumPrice;
        } catch (error) {
          ethereumPriceElement.textContent = "Failed to fetch Ethereum price.";
          console.error(error);
        }
      }

      fetchEthereumPrice();

      //TOOLTIP
      const tooltipTriggerList = document.querySelectorAll(
        '[data-bs-toggle="tooltip"]'
      );
      const tooltipList = [...tooltipTriggerList].map(
        (tooltipTriggerEl) => new bootstrap.Tooltip(tooltipTriggerEl)
      );

      //GET SUPPLY NUMBER
      const contractABI = [
        {
          inputs: [
            { internalType: "uint256", name: "_startTime", type: "uint256" },
            { internalType: "bool", name: "_paused", type: "bool" },
          ],
          stateMutability: "nonpayable",
          type: "constructor",
        },
        {
          inputs: [],
          name: "ApprovalCallerNotOwnerNorApproved",
          type: "error",
        },
        { inputs: [], name: "ApprovalQueryForNonexistentToken", type: "error" },
        { inputs: [], name: "BalanceQueryForZeroAddress", type: "error" },
        { inputs: [], name: "MintERC2309QuantityExceedsLimit", type: "error" },
        { inputs: [], name: "MintToZeroAddress", type: "error" },
        { inputs: [], name: "MintZeroQuantity", type: "error" },
        { inputs: [], name: "OwnerQueryForNonexistentToken", type: "error" },
        {
          inputs: [],
          name: "OwnershipNotInitializedForExtraData",
          type: "error",
        },
        {
          inputs: [],
          name: "TransferCallerNotOwnerNorApproved",
          type: "error",
        },
        { inputs: [], name: "TransferFromIncorrectOwner", type: "error" },
        {
          inputs: [],
          name: "TransferToNonERC721ReceiverImplementer",
          type: "error",
        },
        { inputs: [], name: "TransferToZeroAddress", type: "error" },
        { inputs: [], name: "URIQueryForNonexistentToken", type: "error" },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "owner",
              type: "address",
            },
            {
              indexed: true,
              internalType: "address",
              name: "approved",
              type: "address",
            },
            {
              indexed: true,
              internalType: "uint256",
              name: "tokenId",
              type: "uint256",
            },
          ],
          name: "Approval",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "owner",
              type: "address",
            },
            {
              indexed: true,
              internalType: "address",
              name: "operator",
              type: "address",
            },
            {
              indexed: false,
              internalType: "bool",
              name: "approved",
              type: "bool",
            },
          ],
          name: "ApprovalForAll",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "uint256",
              name: "fromTokenId",
              type: "uint256",
            },
            {
              indexed: false,
              internalType: "uint256",
              name: "toTokenId",
              type: "uint256",
            },
            {
              indexed: true,
              internalType: "address",
              name: "from",
              type: "address",
            },
            {
              indexed: true,
              internalType: "address",
              name: "to",
              type: "address",
            },
          ],
          name: "ConsecutiveTransfer",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "previousOwner",
              type: "address",
            },
            {
              indexed: true,
              internalType: "address",
              name: "newOwner",
              type: "address",
            },
          ],
          name: "OwnershipTransferred",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "from",
              type: "address",
            },
            {
              indexed: true,
              internalType: "address",
              name: "to",
              type: "address",
            },
            {
              indexed: true,
              internalType: "uint256",
              name: "tokenId",
              type: "uint256",
            },
          ],
          name: "Transfer",
          type: "event",
        },
        {
          inputs: [
            { internalType: "address", name: "to", type: "address" },
            { internalType: "uint256", name: "tokenId", type: "uint256" },
          ],
          name: "approve",
          outputs: [],
          stateMutability: "payable",
          type: "function",
        },
        {
          inputs: [{ internalType: "address", name: "owner", type: "address" }],
          name: "balanceOf",
          outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "baseURI",
          outputs: [{ internalType: "string", name: "", type: "string" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [
            { internalType: "uint256", name: "tokenId", type: "uint256" },
          ],
          name: "getApproved",
          outputs: [{ internalType: "address", name: "", type: "address" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [
            { internalType: "address", name: "owner", type: "address" },
            { internalType: "address", name: "operator", type: "address" },
          ],
          name: "isApprovedForAll",
          outputs: [{ internalType: "bool", name: "", type: "bool" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "maxMintPerTx",
          outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "maxMints",
          outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "maxSupply",
          outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [
            { internalType: "uint256", name: "quantity", type: "uint256" },
          ],
          name: "mint",
          outputs: [],
          stateMutability: "payable",
          type: "function",
        },
        {
          inputs: [],
          name: "mintPaused",
          outputs: [{ internalType: "bool", name: "", type: "bool" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "mintRate",
          outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "name",
          outputs: [{ internalType: "string", name: "", type: "string" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "owner",
          outputs: [{ internalType: "address", name: "", type: "address" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [
            { internalType: "uint256", name: "tokenId", type: "uint256" },
          ],
          name: "ownerOf",
          outputs: [{ internalType: "address", name: "", type: "address" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "pauseMint",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [],
          name: "renounceOwnership",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [],
          name: "resumeMint",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            { internalType: "address", name: "from", type: "address" },
            { internalType: "address", name: "to", type: "address" },
            { internalType: "uint256", name: "tokenId", type: "uint256" },
          ],
          name: "safeTransferFrom",
          outputs: [],
          stateMutability: "payable",
          type: "function",
        },
        {
          inputs: [
            { internalType: "address", name: "from", type: "address" },
            { internalType: "address", name: "to", type: "address" },
            { internalType: "uint256", name: "tokenId", type: "uint256" },
            { internalType: "bytes", name: "_data", type: "bytes" },
          ],
          name: "safeTransferFrom",
          outputs: [],
          stateMutability: "payable",
          type: "function",
        },
        {
          inputs: [
            { internalType: "address", name: "operator", type: "address" },
            { internalType: "bool", name: "approved", type: "bool" },
          ],
          name: "setApprovalForAll",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            { internalType: "string", name: "newBaseURI", type: "string" },
          ],
          name: "setBaseURI",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            { internalType: "uint256", name: "_maxMintPerTx", type: "uint256" },
          ],
          name: "setMaxMintPerTx",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [],
          name: "startTime",
          outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [
            { internalType: "bytes4", name: "interfaceId", type: "bytes4" },
          ],
          name: "supportsInterface",
          outputs: [{ internalType: "bool", name: "", type: "bool" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "symbol",
          outputs: [{ internalType: "string", name: "", type: "string" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [
            { internalType: "uint256", name: "tokenId", type: "uint256" },
          ],
          name: "tokenURI",
          outputs: [{ internalType: "string", name: "", type: "string" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [],
          name: "totalSupply",
          outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [
            { internalType: "address", name: "from", type: "address" },
            { internalType: "address", name: "to", type: "address" },
            { internalType: "uint256", name: "tokenId", type: "uint256" },
          ],
          name: "transferFrom",
          outputs: [],
          stateMutability: "payable",
          type: "function",
        },
        {
          inputs: [
            { internalType: "address", name: "newOwner", type: "address" },
          ],
          name: "transferOwnership",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            { internalType: "uint256", name: "newRate", type: "uint256" },
          ],
          name: "updateMintRate",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [],
          name: "withdraw",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
      ];
      const contractAddress = "0x993B1F0DE72A188207D5Cb58e27D6e5050D1AD69"; // Replace with your contract's address

      async function getTotalSupply() {
        // Connect to Ethereum network
        const web3 = new Web3(
          "https://mainnet.infura.io/v3/4daa3d96cf9f44e1b11db916f47b2b88"
        );

        // Load contract
        const contract = new web3.eth.Contract(contractABI, contractAddress);

        // Access totalSupply
        const totalSupply = await contract.methods.totalSupply().call();
        // Find the HTML element to update
        const totalSupplyElement = document.getElementById("totalSupply");
        const progressBar = document.getElementById("progress-supply");

        // Update the HTML element with the value
        totalSupplyElement.textContent = `CREATURES PURCHASED: ${totalSupply}/10,000`;
        progressBar.style.width = `${Number(totalSupply) * 0.01}%`;
      }
      getTotalSupply();

      async function connectMetaMask() {
        if (window.ethereum) {
          window.web3 = new Web3(window.ethereum);
          try {
            // Request account access
            await window.ethereum.request({ method: "eth_requestAccounts" });

            // Get the connected account
            const accounts = await web3.eth.getAccounts();
            console.log("Connected account:", accounts[0]);

            return true;
          } catch (error) {
            console.error("User denied account access");
            return false;
          }
        } else {
          console.error("No web3 provider detected");
          return false;
        }
      }

      // Mint NFT function
      async function mintNFT() {
        const connected = await connectMetaMask();
        if (!connected) {
          const exampleModalEl = document.getElementById("not-connected");
          const modal = new bootstrap.Modal(exampleModalEl);
          modal.show();
          // alert("Please connect to MetaMask");
          return;
        }

        const contractAddress = "0xf26F5aF657487f6e0E069CBe6039D7cd8A49E63D";
        const abi = [{"inputs":[{"internalType":"uint256","name":"_startTime","type":"uint256"},{"internalType":"bool","name":"_paused","type":"bool"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ApprovalCallerNotOwnerNorApproved","type":"error"},{"inputs":[],"name":"ApprovalQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"BalanceQueryForZeroAddress","type":"error"},{"inputs":[],"name":"MintERC2309QuantityExceedsLimit","type":"error"},{"inputs":[],"name":"MintToZeroAddress","type":"error"},{"inputs":[],"name":"MintZeroQuantity","type":"error"},{"inputs":[],"name":"OwnerQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"OwnershipNotInitializedForExtraData","type":"error"},{"inputs":[],"name":"TransferCallerNotOwnerNorApproved","type":"error"},{"inputs":[],"name":"TransferFromIncorrectOwner","type":"error"},{"inputs":[],"name":"TransferToNonERC721ReceiverImplementer","type":"error"},{"inputs":[],"name":"TransferToZeroAddress","type":"error"},{"inputs":[],"name":"URIQueryForNonexistentToken","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"fromTokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"toTokenId","type":"uint256"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"ConsecutiveTransfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"baseURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maxMintPerTx","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maxMints","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maxSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"quantity","type":"uint256"}],"name":"mint","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"mintPaused","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"mintRate","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"pauseMint","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"resumeMint","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"_data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"newBaseURI","type":"string"}],"name":"setBaseURI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_maxMintPerTx","type":"uint256"}],"name":"setMaxMintPerTx","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"startTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"newRate","type":"uint256"}],"name":"updateMintRate","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}]
        const price = currPrice;
        const quantity = document.getElementById("nftQuantity").value;

        const web3 = window.web3;
        const accounts = await web3.eth.getAccounts();
        const contract = new web3.eth.Contract(abi, contractAddress);
        const loadingModal = document.getElementById("loading");
        const loadModal = new bootstrap.Modal(loadingModal);
        try {
          const value = web3.utils.toWei(price, "ether");
          const mintedNFT = await contract.methods.mint(Number(quantity).toFixed(0)).send({
            from: accounts[0],
            value: Number(value).toFixed(2) * Number(quantity),
          }).on('transactionHash', function(hash){
            loadModal.show();
          })
          const receipt = await mintedNFT;
          const tokenIdHex = receipt.logs[0].topics[3];// Get the tokenId hex from the event
          const tokenId = web3.utils.hexToNumber(tokenIdHex);
          const nftPicture = "https://bafybeiad75a3ju6xvfly3icpp3aj5bxjvhjeyuwckfiy5xonzueujdtuzm.ipfs.nftstorage.link/"+tokenId+".png"
          document.getElementById("my-nft").src = nftPicture;
          const successModal = document.getElementById("success");
          const modal = new bootstrap.Modal(successModal);
          loadModal.hide();
          modal.show();
        } catch (error) {
          console.log("this was the error: ", error);
          const failModal = document.getElementById("fail");
          const modal = new bootstrap.Modal(failModal);
          modal.show();
        }

        // Add event listener to mint button
        document.getElementById("mintButton").addEventListener("click", mintNFT);
      }
    </script>
  </body>
</html>
